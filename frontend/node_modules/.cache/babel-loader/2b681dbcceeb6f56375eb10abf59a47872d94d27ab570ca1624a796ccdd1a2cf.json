{"ast":null,"code":"import'./App.css';import{Navigate,useNavigate,Routes,Route}from'react-router-dom';import{useAuth}from'./contexts/AuthContext';import{useEffect,Suspense}from'react';/* Pages */import LoginPage from'./pages/login';import DashboardPage from'./pages/dashboard';import LoadingPage from'./pages/loading';import HomePage from'./pages/home';/* */import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const PublicRoute=_ref=>{let{children}=_ref;return children;};const PrivateRoute=_ref2=>{let{children}=_ref2;const{authenticated}=useAuth();const navigate=useNavigate();useEffect(()=>{if(!authenticated){navigate('/login/');return;}});return children;};const AuthRoute=_ref3=>{let{children}=_ref3;const{authenticated}=useAuth();const navigate=useNavigate();console.log(\"Authenticated: \",authenticated);useEffect(()=>{if(authenticated){navigate('/dashboard/');return;}});return children;};function AppContent(){const{authenticated,setAuthenticated}=useAuth();const navigate=useNavigate();useEffect(()=>{async function validateToken(token){await fetch('https://columbariummanagementsystembackend.onrender.com//api/verify-token/',{method:'GET',headers:{'Content-Type':'application/json','Session-Token':token}}).then(response=>{if(response.ok){setAuthenticated(true);console.log(\"Token valid\");console.log(\"Authenticated2: \",authenticated);}else{console.log(response.json());setAuthenticated(false);sessionStorage.removeItem('token');sessionStorage.removeItem('username');}});}const token=sessionStorage.getItem('token');if(token){// Validate token with backend \nvalidateToken(token);}},[]);return/*#__PURE__*/_jsx(\"div\",{className:\"App\",children:/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"\",element:/*#__PURE__*/_jsx(Navigate,{to:\"/home/\",replace:true})}),/*#__PURE__*/_jsx(Route,{path:\"/login/\",element:/*#__PURE__*/_jsx(AuthRoute,{children:/*#__PURE__*/_jsx(Suspense,{fallback:/*#__PURE__*/_jsx(LoadingPage,{}),children:/*#__PURE__*/_jsx(LoginPage,{})})})}),/*#__PURE__*/_jsx(Route,{path:\"/home/\",element:/*#__PURE__*/_jsx(PublicRoute,{children:/*#__PURE__*/_jsx(Suspense,{fallback:/*#__PURE__*/_jsx(LoadingPage,{}),children:/*#__PURE__*/_jsx(HomePage,{})})})}),/*#__PURE__*/_jsx(Route,{path:\"/dashboard/\",element:/*#__PURE__*/_jsx(PrivateRoute,{children:/*#__PURE__*/_jsx(Suspense,{fallback:/*#__PURE__*/_jsx(LoadingPage,{}),children:/*#__PURE__*/_jsx(DashboardPage,{})})})})]})});}function App(){return/*#__PURE__*/_jsx(AppContent,{});}export default App;","map":{"version":3,"names":["Navigate","useNavigate","Routes","Route","useAuth","useEffect","Suspense","LoginPage","DashboardPage","LoadingPage","HomePage","jsx","_jsx","jsxs","_jsxs","PublicRoute","_ref","children","PrivateRoute","_ref2","authenticated","navigate","AuthRoute","_ref3","console","log","AppContent","setAuthenticated","validateToken","token","fetch","method","headers","then","response","ok","json","sessionStorage","removeItem","getItem","className","path","element","to","replace","fallback","App"],"sources":["C:/Users/LenovO/Documents/OtherProjects/ColumbariumManagementSystem/frontend/src/App.js"],"sourcesContent":["\nimport './App.css';\n\nimport { Navigate, useNavigate, Routes, Route} from 'react-router-dom'\nimport { useAuth } from './contexts/AuthContext';\nimport { useEffect, Suspense } from 'react';\n\n/* Pages */\nimport LoginPage from './pages/login';\nimport DashboardPage from './pages/dashboard';\nimport LoadingPage from './pages/loading';\nimport HomePage from './pages/home';\n/* */\n\n\n\nconst PublicRoute = ({ children }) => {\n  return children;\n}\n\nconst PrivateRoute = ({ children }) => {\n  const { authenticated } = useAuth();\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    if (!authenticated) {\n      navigate('/login/');\n      return;\n    }\n  })\n\n  return children\n}\n\nconst AuthRoute = ({ children }) => {\n  const { authenticated } = useAuth();\n  const navigate = useNavigate(); \n  console.log(\"Authenticated: \", authenticated);\n\n  useEffect(() => {\n    if (authenticated) {\n      navigate('/dashboard/');\n      return;\n    }\n  })\n\n  return children;\n}\n\nfunction AppContent() {\n  const { authenticated, setAuthenticated } = useAuth();\n  const navigate = useNavigate();\n  useEffect(() => {\n    async function validateToken(token) {\n      await fetch('https://columbariummanagementsystembackend.onrender.com//api/verify-token/', {\n        method: 'GET',\n        headers: {\n          'Content-Type': 'application/json',\n          'Session-Token': token,\n        }\n        \n      }).then(response => {\n        if (response.ok) {\n          setAuthenticated(true);\n          console.log(\"Token valid\");\n\n          console.log(\"Authenticated2: \", authenticated);\n        } else {\n          console.log(response.json());\n          setAuthenticated(false);\n          sessionStorage.removeItem('token');\n          sessionStorage.removeItem('username');\n        }\n      })\n    }\n\n    const token = sessionStorage.getItem('token');\n    if (token) {\n      // Validate token with backend \n      validateToken(token);\n    }\n  }, [])\n\n  return (\n    <div className=\"App\">\n        <Routes>\n          <Route path=\"\" element={\n              <Navigate to=\"/home/\" replace />\n          } />\n\n          <Route path=\"/login/\" element ={\n              <AuthRoute>\n                <Suspense fallback={<LoadingPage />}>\n                  <LoginPage />\n                </Suspense>\n              </AuthRoute>\n          } />\n\n          <Route path=\"/home/\" element = {\n              <PublicRoute>\n                <Suspense fallback={<LoadingPage />}>\n                  <HomePage />\n                </Suspense>\n              </PublicRoute>\n          } />\n\n\n          <Route path=\"/dashboard/\" element = {\n              <PrivateRoute>\n                <Suspense fallback={<LoadingPage />}>\n                  <DashboardPage />\n                </Suspense>\n              </PrivateRoute>\n          } />\n        </Routes>\n    </div>\n  );\n}\n\nfunction App () {\n  return (\n      <AppContent />\n\n  )\n}\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
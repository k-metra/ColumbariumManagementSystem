{"ast":null,"code":"import _objectSpread from\"C:/Users/LenovO/Documents/OtherProjects/ColumbariumManagementSystem/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import Icon from\"../components/icon\";import{useState,useEffect,useRef}from\"react\";import{useAuth}from\"../contexts/AuthContext\";import StatusTag from'../components/dashboard/statusTag';import TabContent from'../components/dashboard/tabContent';import LoadingPage from'./loading';import CreateNewElement from\"../components/dashboard/createNewElement\";import EditElement from\"../components/dashboard/editElement\";import AccountModal from\"../components/dashboard/accountModal\";import{fieldsByTab}from\"../config/dashboard/fieldsByTab\";import Tab from'../components/dashboard/tab';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";function getCsrf(){const cookies=document.cookie.split(';');for(let i=0;i<cookies.length;i++){const cookie=cookies[i].trim();if(cookie.startsWith('csrftoken=')){return cookie.substring('csrftoken='.length,cookie.length);}}}export default function DashboardPage(){const[loading,setLoading]=useState(true);const{username,setUsername}=useAuth();const[selectedTab,setSelectedTab]=useState(\"Customers\");const[sidebarOpen,setSidebarOpen]=useState(true);const[searchQuery,setSearchQuery]=useState(\"\");const[openCreateModal,setOpenCreateModal]=useState(false);const[showEditModal,setShowEditModal]=useState(false);const[tableLoading,setTableLoading]=useState(false);const[selectedElements,setSelectedElements]=useState([]);const[elementToEdit,setElementToEdit]=useState(null);const[elements,setElements]=useState([]);const[openAccountModal,setOpenAccountModal]=useState(false);const accountModalRef=useRef(null);const[filter,setFilter]=useState(\"\");const[customerOptions,setCustomerOptions]=useState([]);const[nicheOptions,setNicheOptions]=useState([]);async function fetchItems(endpoint){setTableLoading(true);setElements([]);console.log(endpoint,\" fetching items.\");try{await fetch(\"https://columbariummanagementsystembackend.onrender.com//api/\".concat(endpoint.toLowerCase(),\"/list-all/\"),{method:'GET',headers:{'Content-Type':'application/json','Session-Token':sessionStorage.getItem('token'),'Authorization':\"Session \".concat(sessionStorage.getItem('token'))},credentials:'include'}).then(response=>{if(!response.ok){throw new Error(\"Failed to fetch items\");}else{return response.json();}}).then(data=>{const normalizeKey=s=>s.replace(/_([a-z])/g,(_,c)=>c.toUpperCase());const normalizeObject=obj=>{if(obj===null||obj===undefined)return obj;if(Array.isArray(obj))return obj.map(normalizeObject);if(typeof obj!=='object')return obj;const res={};Object.keys(obj).forEach(k=>{const newKey=normalizeKey(k);const val=obj[k];res[newKey]=normalizeObject(val);});return res;};setTableLoading(false);const normalized=Array.isArray(data)?data.map(normalizeObject):data;setElements(normalized);console.log(\"Fetched items (normalized): \",normalized);});}catch(Exception){console.log(\"Error fetching items: \",Exception);}}// convert camelCase keys used in the UI back to snake_case for the API\nconst camelToSnake=s=>s.replace(/([A-Z])/g,m=>'_'+m.toLowerCase());const convertKeysToSnake=obj=>{if(obj===null||obj===undefined)return obj;if(Array.isArray(obj))return obj.map(convertKeysToSnake);if(obj instanceof Date)return obj.toISOString();if(typeof obj!=='object')return obj;const res={};Object.keys(obj).forEach(k=>{const newKey=camelToSnake(k);res[newKey]=convertKeysToSnake(obj[k]);});return res;};const handleEditClick=()=>{if(selectedElements.length===1){// ensure customer options are loaded when editing Payments\nconst prepareAndShow=async()=>{if(selectedTab==='Payments')await fetchCustomerOptions();setElementToEdit(elements.find(e=>e.id===selectedElements[0]));setShowEditModal(true);};prepareAndShow();}};async function handleRemoveSelected(e){e.preventDefault();if(selectedElements.length===0)return;const endpoint=selectedTab.toLowerCase();const confirmation=window.confirm(\"Are you sure you want to delete \".concat(selectedElements.length,\" items? This action cannot be undone.\"));if(confirmation){try{await fetch(\"https://columbariummanagementsystembackend.onrender.com//api/\".concat(endpoint,\"/delete/\"),{method:'DELETE',headers:{'Content-Type':'application/json','Session-Token':sessionStorage.getItem('token'),'Authorization':\"Session \".concat(sessionStorage.getItem('token')),'X-CSRFToken':getCsrf()},body:JSON.stringify({element_ids:selectedElements}),credentials:'include'});}catch(Exception){console.log(\"Error deleting items: \",Exception);}finally{setSelectedElements([]);await fetchItems(selectedTab);}}}const handleEdit=async data=>{// close on both edit and cancel\nsetShowEditModal(false);if(data===null)return;const endpoint=selectedTab.toLowerCase();try{// convert field names to snake_case before sending to API\nconst payload=convertKeysToSnake(data);await fetch(\"https://columbariummanagementsystembackend.onrender.com//api/\".concat(endpoint,\"/edit/?\").concat(endpoint.slice(0,-1),\"_id=\").concat(elementToEdit.id),{method:'PUT',headers:{'Content-Type':'application/json','Session-Token':sessionStorage.getItem('token'),'Authorization':\"Session \".concat(sessionStorage.getItem('token')),'X-CSRFToken':getCsrf()},body:JSON.stringify(payload),credentials:'include'}).then(response=>{if(!response.ok){console.log(\"Failed to edit item\");}return response.json();}).then(data=>{console.log(data);});}catch(Exception){}finally{setSelectedElements([]);setElementToEdit(null);fetchItems(selectedTab);}};const handleCreate=async data=>{// close on both create and cancel\nsetOpenCreateModal(false);// cancel action (CreateNewElement calls onCreate(null) on cancel)\nconsole.log('handleCreate received data:',data);if(data===null)return;const endpoint=selectedTab.toLowerCase();try{// ensure we have an object to convert\nconst safeData=data||{};// convert field names to snake_case before sending to API\nconst payload=convertKeysToSnake(safeData);console.log('Creating',endpoint,'payload:',payload);await fetch(\"https://columbariummanagementsystembackend.onrender.com//api/\"+endpoint+\"/create-new/\",{method:'POST',headers:{'Content-Type':'application/json','Session-Token':sessionStorage.getItem('token'),'Authorization':\"Session \".concat(sessionStorage.getItem('token')),'X-CSRFToken':getCsrf()},body:JSON.stringify(payload),credentials:'include'}).then(response=>{if(!response.ok){throw new Error(\"Failed to create item\");}return response.json();}).then(data=>{console.log(data);});await fetchItems(selectedTab);}catch(error){console.error(\"Error creating item: \",error);}};useEffect(()=>{setFilter(\"\");const storedUsername=username||sessionStorage.getItem('username');if(storedUsername){setUsername(storedUsername);}fetchItems(selectedTab);const loader=setTimeout(()=>{setLoading(false);},800);return()=>{clearTimeout(loader);};},[username,selectedTab,setUsername]);// for account modal\nuseEffect(()=>{function handleClickOutside(e){if(accountModalRef.current&&!accountModalRef.current.contains(e.target)){setOpenAccountModal(false);}}document.addEventListener('mousedown',handleClickOutside);return()=>document.removeEventListener('mousedown',handleClickOutside);});const handleTabSelect=tab=>{setElements([]);setSelectedElements([]);setSelectedTab(tab);setSearchQuery(\"\");// fetch new items for the selected tab\nconsole.log(\"Switching to tab:\",tab);fetchItems(tab);};// fetch customer names to use as options for Payments.payer select\nconst fetchCustomerOptions=async()=>{try{const res=await fetch('https://columbariummanagementsystembackend.onrender.com//api/customers/list-all/',{method:'GET',headers:{'Content-Type':'application/json','Session-Token':sessionStorage.getItem('token'),'Authorization':\"Session \".concat(sessionStorage.getItem('token'))},credentials:'include'});if(!res.ok)throw new Error('Failed to fetch customers');const data=await res.json();// normalize keys (reuse normalizeKey logic)\nconst normalizeKey=s=>s.replace(/_([a-z])/g,(_,c)=>c.toUpperCase());const normalizeObject=obj=>{if(obj===null||obj===undefined)return obj;if(Array.isArray(obj))return obj.map(normalizeObject);if(typeof obj!=='object')return obj;const res={};Object.keys(obj).forEach(k=>{const newKey=normalizeKey(k);res[newKey]=normalizeObject(obj[k]);});setTableLoading(false);return res;};const normalized=Array.isArray(data)?data.map(normalizeObject):[];const opts=normalized.map(c=>({value:c.name,label:c.name||c.fullName||\"#\".concat(String(c.id).padStart(3,'0'))}));setCustomerOptions(opts);}catch(err){console.error('Error fetching customer options',err);setCustomerOptions([]);}};const fetchNicheOptions=async()=>{try{const res=await fetch('https://columbariummanagementsystembackend.onrender.com//api/niches/list-all/',{method:'GET',headers:{'Content-Type':'application/json','Session-Token':sessionStorage.getItem('token'),'Authorization':\"Session \".concat(sessionStorage.getItem('token'))},credentials:'include'});if(!res.ok)throw new Error('Failed to fetch niches');const data=await res.json();const available=data.filter(n=>n.status==='Available');// normalize keys (reuse normalizeKey logic)\nconst normalizeKey=s=>s.replace(/_([a-z])/g,(_,c)=>c.toUpperCase());const normalizeObject=obj=>{if(obj===null||obj===undefined)return obj;if(Array.isArray(obj))return obj.map(normalizeObject).filter(entry=>entry.status==='Available');if(typeof obj!=='object')return obj;const res={};Object.keys(obj).forEach(k=>{const newKey=normalizeKey(k);res[newKey]=normalizeObject(obj[k]);});console.log(res);setTableLoading(false);return res;};const normalized=Array.isArray(available)?available.map(normalizeObject):[];const opts=normalized.map(n=>{var _n$location;return{value:n.id,label:\"\".concat((_n$location=n.location)!==null&&_n$location!==void 0?_n$location:'No location',\" - #\").concat(String(n.id).padStart(3,'0'))||\"#\".concat(String(n.id).padStart(3,'0'))};});setNicheOptions(opts);}catch(err){console.error('Error fetching niche options',err);setNicheOptions([]);}};const handleSelectRow=id=>{console.log(id);setSelectedElements(prev=>prev.includes(id)?prev.filter(ppid=>ppid!==id):[...prev,id]);};const handleSelectAll=checked=>{if(checked)setSelectedElements(elements.map(p=>p.id));else setSelectedElements([]);};if(loading)return/*#__PURE__*/_jsx(LoadingPage,{});return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen screen overflow-auto items-center flex flex-col bg-[#fbfbfb]\",children:[/*#__PURE__*/_jsx(\"title\",{children:\"Dashboard\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"min-w-[90%] min-h-[80%] max-w-[100%] max-h-[100%]\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"header bg-white w-full self-center flex flex-row justify-between mt-3 rounded-lg p-4 drop-shadow-md\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-row items-center\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:e=>{setSidebarOpen(!sidebarOpen);},className:\"p-2 text-[22px] rounded-full hover:bg-black/10 text-zinc-700 mr-4\",children:/*#__PURE__*/_jsx(Icon,{icon:\"fa-solid fa-bars\"})}),/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl font-bold text-zinc-700\",children:\"Columbarium Dashboard\"})]}),/*#__PURE__*/_jsx(\"div\",{id:\"accountControl\",className:\"flex flex-row items-center\",children:/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setOpenAccountModal(!openAccountModal),className:\"p-2 hover:underline text-md text-zinc-700 mr-4\",children:[/*#__PURE__*/_jsx(Icon,{icon:\"fa-solid fa-user\",className:\"mr-3\"}),username!==\"\"?username:\"User Not Found\"]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"lg:w-[100%] md:w-[90%] h-[85%] flex flex-row gap-3\",children:[sidebarOpen&&/*#__PURE__*/_jsxs(\"div\",{className:\"sidebar bg-white w-[20%] h-full self-start flex flex-col mt-3 rounded-lg p-4 drop-shadow-md gap-1\",children:[/*#__PURE__*/_jsx(Tab,{onClick:()=>handleTabSelect(\"Customers\"),icon:\"fa-solid fa-users\",children:\"Customers\"}),/*#__PURE__*/_jsx(Tab,{onClick:()=>handleTabSelect(\"Payments\"),icon:\"fa-solid fa-credit-card\",children:\"Payments\"}),/*#__PURE__*/_jsx(Tab,{onClick:()=>handleTabSelect(\"Accounts\"),icon:\"fa-solid fa-wallet\",children:\"Accounts\"}),/*#__PURE__*/_jsx(Tab,{onClick:()=>handleTabSelect(\"Contacts\"),icon:\"fa-solid fa-address-book\",children:\"Contacts\"}),/*#__PURE__*/_jsx(Tab,{onClick:()=>handleTabSelect(\"Occupants\"),icon:\"fa-solid fa-box-open\",children:\"Occupants\"}),/*#__PURE__*/_jsx(Tab,{onClick:()=>handleTabSelect(\"Niches\"),icon:\"fa-solid fa-square-person-confined\",children:\"Niches\"}),sessionStorage.getItem(\"permissions\").split(\",\").includes(\"view_audit\")&&/*#__PURE__*/_jsx(Tab,{onClick:()=>handleTabSelect(\"Audit\"),icon:\"fa-solid fa-users\",children:\"Audit Logs\"}),sessionStorage.getItem(\"permissions\").split(\",\").includes(\"manage_users\")&&/*#__PURE__*/_jsx(Tab,{onClick:()=>handleTabSelect(\"Users\"),icon:\"fa-solid fa-user-shield\",children:\"User Management\"}),/*#__PURE__*/_jsx(Tab,{onClick:()=>handleTabSelect(\"Analytics\"),icon:\"fa-solid fa-chart-simple\",children:\"Analytics\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"content transition-all duration-300 ease-out bg-white w-full h-full flex flex-col mt-3 rounded-lg p-4 drop-shadow-md overflow-auto\",children:(()=>{const tabs={Customers:{columns:[{label:\"\",key:\"_select\"},{label:\"Customer ID\",key:\"id\",type:'number'},{label:\"Full Name\",key:\"name\",type:'text'},{label:\"Contact Number\",key:\"contactNumber\",type:'text'},{label:\"Email\",key:\"email\",type:'text'},{label:\"Address\",key:\"address\",type:'text'},{label:\"Deceased's Name\",key:\"deceasedName\",type:'text'},{label:\"Date Deceased\",key:\"deceasedDate\",type:'date'},{label:\"Relationship to Deceased\",key:\"relationshipToDeceased\",type:'text'}],toolbarButtons:[{label:'Add Customer',icon:'fa-solid fa-plus',bg:'bg-blue-500',textClass:'text-white',onClick:()=>setOpenCreateModal(true)},{label:'Edit Selected',icon:'fa-solid fa-pencil',onClick:e=>{handleEditClick(e);}},{label:\"(\".concat(selectedElements.length,\") Remove Selected\"),icon:'fa fa-trash',bg:'bg-red-500',textClass:'text-white',onClick:e=>{handleRemoveSelected(e);}}],rowRenderer:row=>{var _row$id,_row$name,_row$contactNumber,_row$email,_row$address,_row$deceasedName,_row$deceasedDate,_row$relationshipToDe;return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"td\",{className:\"p-2\",children:[\"#\",((_row$id=row.id)!==null&&_row$id!==void 0?_row$id:'').toString().padStart(3,\"0\")]}),/*#__PURE__*/_jsx(\"td\",{className:\"p-2\",children:(_row$name=row.name)!==null&&_row$name!==void 0?_row$name:''}),/*#__PURE__*/_jsx(\"td\",{className:\"p-2\",children:(_row$contactNumber=row.contactNumber)!==null&&_row$contactNumber!==void 0?_row$contactNumber:''}),/*#__PURE__*/_jsx(\"td\",{className:\"p-2\",children:(_row$email=row.email)!==null&&_row$email!==void 0?_row$email:''}),/*#__PURE__*/_jsx(\"td\",{className:\"p-2\",children:(_row$address=row.address)!==null&&_row$address!==void 0?_row$address:''}),/*#__PURE__*/_jsx(\"td\",{className:\"p-2\",children:(_row$deceasedName=row.deceasedName)!==null&&_row$deceasedName!==void 0?_row$deceasedName:''}),/*#__PURE__*/_jsx(\"td\",{className:\"p-2\",children:(_row$deceasedDate=row.deceasedDate)!==null&&_row$deceasedDate!==void 0?_row$deceasedDate:''}),/*#__PURE__*/_jsx(\"td\",{className:\"p-2\",children:(_row$relationshipToDe=row.relationshipToDeceased)!==null&&_row$relationshipToDe!==void 0?_row$relationshipToDe:''})]});}},Payments:{columns:[{label:\"\",key:\"_select\"},{label:\"Payment ID\",key:\"id\",type:'number'},{label:\"Customer Name\",key:\"payer\",type:'text'},{label:\"Amount Paid\",key:\"amountPaid\",type:'number'},{label:\"Amount Due\",key:\"amountDue\",type:'number'},{label:\"Remaining Balance\",key:\"remainingBalance\",type:'number'},{label:\"Maintenance Fee\",key:\"maintenanceFee\",type:'number'},{label:\"Date Paid\",key:\"paymentDate\",type:'date'},{label:\"Status\",key:\"status\",type:'text'}],toolbarButtons:[{label:'Add Payment',icon:'fa-solid fa-plus',bg:'bg-blue-500',textClass:'text-white',onClick:async()=>{await fetchCustomerOptions();setOpenCreateModal(true);}},{label:'Edit Selected',icon:'fa-solid fa-pencil',onClick:e=>{handleEditClick(e);}},{label:\"(\".concat(selectedElements.length,\") Remove Selected\"),icon:'fa fa-trash',bg:'bg-red-500',textClass:'text-white',onClick:e=>{handleRemoveSelected(e);}}],rowRenderer:row=>{var _row$id2,_ref3,_ref4,_row$amountPaid,_ref5,_row$amountDue,_ref6,_row$remainingBalance,_ref7,_row$maintenanceFee,_ref8,_row$status;return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"td\",{className:\"p-2\",children:[\"#\",((_row$id2=row.id)!==null&&_row$id2!==void 0?_row$id2:'').toString().padStart(3,\"0\")]}),/*#__PURE__*/_jsx(\"td\",{className:\"p-2\",children:function(_ref,_ref2,_row$payer){// prefer 'payer' field; it may contain either the customer id or the name\nconst payerVal=(_ref=(_ref2=(_row$payer=row.payer)!==null&&_row$payer!==void 0?_row$payer:row.payer_id)!==null&&_ref2!==void 0?_ref2:row.payerId)!==null&&_ref!==void 0?_ref:null;// if payerVal matches an option value, show the option label\nconst opt=customerOptions.find(o=>String(o.value)===String(payerVal));if(opt)return opt.label;// otherwise show the raw value (name) if present\nreturn payerVal!==null&&payerVal!==void 0?payerVal:'';}()}),/*#__PURE__*/_jsxs(\"td\",{className:\"p-2\",children:[\"\\u20B1 \",Number((_ref3=(_ref4=(_row$amountPaid=row.amountPaid)!==null&&_row$amountPaid!==void 0?_row$amountPaid:row.amountPaid)!==null&&_ref4!==void 0?_ref4:row.amount_paid)!==null&&_ref3!==void 0?_ref3:0).toLocaleString(\"en-US\",{minimumFractionDigits:2})]}),/*#__PURE__*/_jsxs(\"td\",{className:\"p-2\",children:[\"\\u20B1 \",Number((_ref5=(_row$amountDue=row.amountDue)!==null&&_row$amountDue!==void 0?_row$amountDue:row.amount_due)!==null&&_ref5!==void 0?_ref5:0).toLocaleString(\"en-US\",{minimumFractionDigits:2})]}),/*#__PURE__*/_jsxs(\"td\",{className:\"p-2\",children:[\"\\u20B1 \",Number((_ref6=(_row$remainingBalance=row.remainingBalance)!==null&&_row$remainingBalance!==void 0?_row$remainingBalance:row.remaining_balance)!==null&&_ref6!==void 0?_ref6:0).toLocaleString(\"en-US\",{minimumFractionDigits:2})]}),/*#__PURE__*/_jsxs(\"td\",{className:\"p-2\",children:[\"\\u20B1 \",Number((_ref7=(_row$maintenanceFee=row.maintenanceFee)!==null&&_row$maintenanceFee!==void 0?_row$maintenanceFee:row.maintenance_fee)!==null&&_ref7!==void 0?_ref7:0).toLocaleString(\"en-US\",{minimumFractionDigits:2})]}),/*#__PURE__*/_jsx(\"td\",{className:\"p-2\",children:row.paymentDate?new Intl.DateTimeFormat('en-US').format(new Date(row.paymentDate)):''}),/*#__PURE__*/_jsx(\"td\",{className:\"p-2\",children:/*#__PURE__*/_jsx(StatusTag,{status:(_ref8=(_row$status=row.status)!==null&&_row$status!==void 0?_row$status:row.state)!==null&&_ref8!==void 0?_ref8:''})})]});}},Accounts:{columns:[{label:\"\",key:\"_select\"},{label:\"Account ID\",key:\"id\",type:'number'},{label:\"Customer Name\",key:\"customerName\",type:'text'}],toolbarButtons:[],rowRenderer:row=>{var _row$id3,_row$customerName;/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"td\",{className:\"p-2\",children:(_row$id3=row.id)!==null&&_row$id3!==void 0?_row$id3:''}),/*#__PURE__*/_jsx(\"td\",{className:\"p-2\",children:(_row$customerName=row.customerName)!==null&&_row$customerName!==void 0?_row$customerName:''})]});}},Transactions:{columns:[{label:\"\",key:\"_select\"},{label:\"Transaction #\",key:\"id\",type:'number'},{label:\"Account\",key:\"account\",type:'text'},{label:\"Date of Transaction\",key:\"date\",type:'date'},{label:\"Type of Transaction\",key:\"type\",type:\"text\"},{label:\"Processed By\",key:\"processedBy\",type:\"text\"}],toolbarButtons:[{label:\"Add Transaction\",icon:\"fa-solid fa-plus\",onClick:setOpenCreateModal},{label:\"Edit Selected\",icon:\"fa-solid fa-pen-to-square\",onClick:handleEditClick},{label:\"Remove Selected\",icon:\"fa-solid fa-trash\",onClick:handleRemoveSelected}],rowRenderer:row=>{var _row$account,_row$type,_row$processedBy;return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"td\",{className:\"p-2\",children:row.id?row.id.padStart(3,\"0\"):''}),/*#__PURE__*/_jsx(\"td\",{className:\"p-2\",children:(_row$account=row.account)!==null&&_row$account!==void 0?_row$account:''}),/*#__PURE__*/_jsx(\"td\",{className:\"p-2\",children:row.date?new Intl.DateTimeFormat('en-US').format(new Date(row.date)):''}),/*#__PURE__*/_jsx(\"td\",{className:\"p-2\",children:(_row$type=row.type)!==null&&_row$type!==void 0?_row$type:''}),/*#__PURE__*/_jsx(\"td\",{className:\"p-2\",children:(_row$processedBy=row.processedBy)!==null&&_row$processedBy!==void 0?_row$processedBy:''})]});}},Contacts:{columns:[{label:\"\",key:\"_select\"},{label:\"Contact ID\",key:\"id\",type:'number'},{label:\"Family Name\",key:\"familyName\",type:'text'},{label:\"Deceased's Name\",key:\"deceasedName\",type:'text'},{label:\"Deceased Date\",key:\"deceasedDate\",type:'date'},{label:\"Address\",key:\"address\",type:'text'},{label:\"Contact Number\",key:\"contactNumber\",type:'text'}],toolbarButtons:[{label:'Add Contact',icon:'fa-solid fa-plus',bg:'bg-blue-500',textClass:'text-white',onClick:()=>setOpenCreateModal(true)},{label:'Edit Selected',icon:'fa-solid fa-pencil',onClick:e=>{handleEditClick(e);}},{label:\"(\".concat(selectedElements.length,\") Remove Selected\"),icon:'fa fa-trash',textClass:'text-white',bg:'bg-red-500 text-white',onClick:handleRemoveSelected}],rowRenderer:row=>{var _row$id4,_row$familyName,_row$deceasedName2,_row$address2,_row$contactNumber2,_row$status2;return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"td\",{className:\"p-2\",children:[\"#\",((_row$id4=row.id)!==null&&_row$id4!==void 0?_row$id4:'').toString().padStart(3,\"0\")]}),/*#__PURE__*/_jsx(\"td\",{className:\"p-2\",children:(_row$familyName=row.familyName)!==null&&_row$familyName!==void 0?_row$familyName:''}),/*#__PURE__*/_jsx(\"td\",{className:\"p-2\",children:(_row$deceasedName2=row.deceasedName)!==null&&_row$deceasedName2!==void 0?_row$deceasedName2:''}),/*#__PURE__*/_jsx(\"td\",{className:\"p-2\",children:row.deceasedDate?new Intl.DateTimeFormat('en-US').format(new Date(row.deceasedDate)):''}),/*#__PURE__*/_jsx(\"td\",{className:\"p-2\",children:(_row$address2=row.address)!==null&&_row$address2!==void 0?_row$address2:''}),/*#__PURE__*/_jsx(\"td\",{className:\"p-2\",children:(_row$contactNumber2=row.contactNumber)!==null&&_row$contactNumber2!==void 0?_row$contactNumber2:''}),/*#__PURE__*/_jsx(\"td\",{className:\"p-2\",children:/*#__PURE__*/_jsx(StatusTag,{status:(_row$status2=row.status)!==null&&_row$status2!==void 0?_row$status2:''})})]});}},Occupants:{columns:[{label:\"\",key:\"_select\"},{label:\"Occupant ID\",key:\"id\",type:'number'},{label:\"Name\",key:\"name\",type:'text'},{label:\"Date of Interment\",key:\"intermentDate\",type:'date'},{label:\"Niche\",key:\"niche\",type:'text'}],toolbarButtons:[{label:'Add Occupant',icon:'fa-solid fa-plus',bg:'bg-blue-500',textClass:'text-white',onClick:async()=>{await fetchNicheOptions();setOpenCreateModal(true);}},{label:'Edit Selected',icon:'fa-solid fa-pencil',onClick:e=>{handleEditClick(e);}},{label:\"(\".concat(selectedElements.length,\") Remove Selected\"),icon:'fa fa-trash',bg:'bg-red-500',textClass:'text-white',onClick:handleRemoveSelected}],rowRenderer:row=>{var _row$id5,_row$name2,_row$niche;return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"td\",{className:\"p-2\",children:[\"#\",((_row$id5=row.id)!==null&&_row$id5!==void 0?_row$id5:'').toString().padStart(3,\"0\")]}),/*#__PURE__*/_jsx(\"td\",{className:\"p-2\",children:(_row$name2=row.name)!==null&&_row$name2!==void 0?_row$name2:''}),/*#__PURE__*/_jsx(\"td\",{className:\"p-2\",children:row.intermentDate?new Intl.DateTimeFormat('en-US').format(new Date(row.intermentDate)):''}),/*#__PURE__*/_jsx(\"td\",{className:\"p-2\",children:(_row$niche=row.niche)!==null&&_row$niche!==void 0?_row$niche:''})]});}},Niches:{columns:[{label:\"\",key:\"_select\"},{label:\"Niche ID\",key:\"id\",type:'number'},{label:\"Amount\",key:\"amount\",type:'number'},{label:\"Location\",key:\"location\",type:'text'},{label:\"Status\",key:\"status\",type:'text'}],toolbarButtons:[{label:'Add Niche',icon:'fa-solid fa-plus',bg:'bg-blue-500',textClass:'text-white',onClick:()=>setOpenCreateModal(true)},{label:'Edit Selected',icon:'fa-solid fa-pencil',onClick:handleEditClick},{label:\"(\".concat(selectedElements.length,\") Remove Selected\"),icon:'fa fa-trash',bg:'bg-red-500',textClass:'text-white',onClick:handleRemoveSelected}],rowRenderer:row=>{var _row$id6,_row$amount,_row$location,_row$status3;return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"td\",{className:\"p-2\",children:[\"#\",((_row$id6=row.id)!==null&&_row$id6!==void 0?_row$id6:'').toString().padStart(3,\"0\")]}),/*#__PURE__*/_jsxs(\"td\",{className:\"p-2\",children:[\"\\u20B1 \",Number((_row$amount=row.amount)!==null&&_row$amount!==void 0?_row$amount:0).toLocaleString('en-US',{minimumFractionDigits:2})]}),/*#__PURE__*/_jsx(\"td\",{className:\"p-2\",children:(_row$location=row.location)!==null&&_row$location!==void 0?_row$location:''}),/*#__PURE__*/_jsx(\"td\",{className:\"p-2\",children:/*#__PURE__*/_jsx(StatusTag,{status:(_row$status3=row.status)!==null&&_row$status3!==void 0?_row$status3:''})})]});}},Audit:{columns:[{label:\"User\",key:\"user\",type:'text'},{label:\"Role\",key:\"role\",type:'text'},{label:\"IP Address\",key:\"ipAddress\",type:'text'},{label:\"Object ID\",key:\"objectId\",type:'text'},{label:\"Action\",key:\"action\",type:'text'},{label:\"Application\",key:\"app\",type:'text'},{label:\"URL\",key:\"path\",type:'text'},{label:\"Timestamp\",key:\"timestamp\",type:'date'}],toolbarButtons:[],rowRenderer:row=>{var _row$user,_row$role,_row$ipAddress,_row$responseData$ids,_row$responseData,_row$responseData$ids2,_row$action,_row$app,_row$path;return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"td\",{className:\"p-2\",children:(_row$user=row.user)!==null&&_row$user!==void 0?_row$user:''}),/*#__PURE__*/_jsx(\"td\",{className:\"p-2\",children:(_row$role=row.role)!==null&&_row$role!==void 0?_row$role:''}),/*#__PURE__*/_jsx(\"td\",{className:\"p-2\",children:(_row$ipAddress=row.ipAddress)!==null&&_row$ipAddress!==void 0?_row$ipAddress:''}),/*#__PURE__*/_jsx(\"td\",{className:\"p-2\",children:(_row$responseData$ids=(_row$responseData=row.responseData)===null||_row$responseData===void 0?void 0:(_row$responseData$ids2=_row$responseData.ids)===null||_row$responseData$ids2===void 0?void 0:_row$responseData$ids2.join(', '))!==null&&_row$responseData$ids!==void 0?_row$responseData$ids:''}),/*#__PURE__*/_jsx(\"td\",{className:\"p-2\",children:(_row$action=row.action)!==null&&_row$action!==void 0?_row$action:''}),/*#__PURE__*/_jsx(\"td\",{className:\"p-2\",children:(_row$app=row.app)!==null&&_row$app!==void 0?_row$app:''}),/*#__PURE__*/_jsx(\"td\",{className:\"p-2\",children:(_row$path=row.path)!==null&&_row$path!==void 0?_row$path:''}),/*#__PURE__*/_jsx(\"td\",{className:\"p-2\",children:row.timestamp?new Intl.DateTimeFormat('en-US',{year:'numeric',month:'numeric',day:'numeric',hour:'numeric',minute:'numeric',second:'numeric'}).format(new Date(row.timestamp)):''})]});}},Users:{columns:[{label:\"\",key:\"_select\"},{label:\"User ID\",key:\"id\",type:'number'},{label:\"Username\",key:\"username\",type:'text'},{label:\"Role\",key:\"role\",type:'text'}],toolbarButtons:[{label:'Add User',icon:'fa-solid fa-plus',bg:'bg-blue-500',textClass:'text-white',onClick:()=>setOpenCreateModal(true)},{label:'Edit Selected',icon:'fa-solid fa-pencil',onClick:handleEditClick},{label:\"(\".concat(selectedElements.length,\") Remove Selected\"),icon:'fa fa-trash',bg:'bg-red-500',textClass:'text-white',onClick:handleRemoveSelected}],rowRenderer:row=>{var _row$id7,_row$username,_row$role2;return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"td\",{className:\"p-2\",children:(_row$id7=row.id)!==null&&_row$id7!==void 0?_row$id7:''}),/*#__PURE__*/_jsx(\"td\",{className:\"p-2\",children:(_row$username=row.username)!==null&&_row$username!==void 0?_row$username:''}),/*#__PURE__*/_jsx(\"td\",{className:\"p-2\",children:(_row$role2=row.role)!==null&&_row$role2!==void 0?_row$role2:''})]});}}// Add other tabs here\n};const cfg=tabs[selectedTab];if(!cfg)return null;if(tableLoading)return/*#__PURE__*/_jsx(LoadingPage,{});return/*#__PURE__*/_jsx(TabContent,{title:selectedTab,searchQuery:searchQuery,onSearchChange:setSearchQuery,toolbarButtons:cfg.toolbarButtons,columns:cfg.columns,data:elements.length>0?elements:[],selectedItems:selectedElements,onSelectAll:handleSelectAll,onSelectRow:handleSelectRow,getRowKey:row=>row.id,onFilterChange:value=>setFilter(value),children:cfg.rowRenderer});})()})]})]}),openCreateModal&&(()=>{let fieldsToPass=fieldsByTab[selectedTab];if(selectedTab==='Payments'){// ensure options are available\nconst paymentsFields=(fieldsByTab.Payments||[]).map(f=>_objectSpread({},f));// replace payerId field with select options\nconst baseOpts=customerOptions.length?customerOptions:[{value:'',label:'No customers'}];const optsWithPrompt=[{value:'',label:'Select Customer'},...baseOpts];fieldsToPass=paymentsFields.map(f=>f.name==='payer'?_objectSpread(_objectSpread({},f),{},{type:'select',options:optsWithPrompt}):f);}else if(selectedTab==='Occupants'){const occupantFields=(fieldsByTab.Occupants||[]).map(f=>_objectSpread({},f));const baseOpts=nicheOptions.length?nicheOptions:[{value:'',label:'No niches'}];const optsWithPrompt=[{value:'',label:'Select Niche'},...baseOpts];fieldsToPass=occupantFields.map(f=>f.name==='nicheId'?_objectSpread(_objectSpread({},f),{},{type:'select',options:optsWithPrompt}):f);}return/*#__PURE__*/_jsx(CreateNewElement,{tab:selectedTab,onCreate:handleCreate,fields:fieldsToPass});})(),showEditModal&&(()=>{let editFields=fieldsByTab[selectedTab];if(selectedTab==='Payments'){const paymentsFields=(fieldsByTab.Payments||[]).map(f=>_objectSpread({},f));const baseEditOpts=customerOptions.length?customerOptions:[{value:'',label:'No customers'}];const editOptsWithPrompt=[{value:'',label:'Select Customer'},...baseEditOpts];editFields=paymentsFields.map(f=>f.name==='payer'?_objectSpread(_objectSpread({},f),{},{type:'select',options:editOptsWithPrompt}):f);}return/*#__PURE__*/_jsx(EditElement,{tab:selectedTab,elementData:elementToEdit,fields:editFields,onEdit:handleEdit});})(),/*#__PURE__*/_jsx(\"div\",{ref:accountModalRef,children:/*#__PURE__*/_jsx(AccountModal,{isOpen:openAccountModal,username:username,role:sessionStorage.getItem(\"role\")||'Staff'})})]});}","map":{"version":3,"names":["Icon","useState","useEffect","useRef","useAuth","StatusTag","TabContent","LoadingPage","CreateNewElement","EditElement","AccountModal","fieldsByTab","Tab","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","getCsrf","cookies","document","cookie","split","i","length","trim","startsWith","substring","DashboardPage","loading","setLoading","username","setUsername","selectedTab","setSelectedTab","sidebarOpen","setSidebarOpen","searchQuery","setSearchQuery","openCreateModal","setOpenCreateModal","showEditModal","setShowEditModal","tableLoading","setTableLoading","selectedElements","setSelectedElements","elementToEdit","setElementToEdit","elements","setElements","openAccountModal","setOpenAccountModal","accountModalRef","filter","setFilter","customerOptions","setCustomerOptions","nicheOptions","setNicheOptions","fetchItems","endpoint","console","log","fetch","concat","toLowerCase","method","headers","sessionStorage","getItem","credentials","then","response","ok","Error","json","data","normalizeKey","s","replace","_","c","toUpperCase","normalizeObject","obj","undefined","Array","isArray","map","res","Object","keys","forEach","k","newKey","val","normalized","Exception","camelToSnake","m","convertKeysToSnake","Date","toISOString","handleEditClick","prepareAndShow","fetchCustomerOptions","find","e","id","handleRemoveSelected","preventDefault","confirmation","window","confirm","body","JSON","stringify","element_ids","handleEdit","payload","slice","handleCreate","safeData","error","storedUsername","loader","setTimeout","clearTimeout","handleClickOutside","current","contains","target","addEventListener","removeEventListener","handleTabSelect","tab","opts","value","name","label","fullName","String","padStart","err","fetchNicheOptions","available","n","status","entry","_n$location","location","handleSelectRow","prev","includes","ppid","handleSelectAll","checked","p","className","children","onClick","icon","tabs","Customers","columns","key","type","toolbarButtons","bg","textClass","rowRenderer","row","_row$id","_row$name","_row$contactNumber","_row$email","_row$address","_row$deceasedName","_row$deceasedDate","_row$relationshipToDe","toString","contactNumber","email","address","deceasedName","deceasedDate","relationshipToDeceased","Payments","_row$id2","_ref3","_ref4","_row$amountPaid","_ref5","_row$amountDue","_ref6","_row$remainingBalance","_ref7","_row$maintenanceFee","_ref8","_row$status","_ref","_ref2","_row$payer","payerVal","payer","payer_id","payerId","opt","o","Number","amountPaid","amount_paid","toLocaleString","minimumFractionDigits","amountDue","amount_due","remainingBalance","remaining_balance","maintenanceFee","maintenance_fee","paymentDate","Intl","DateTimeFormat","format","state","Accounts","_row$id3","_row$customerName","customerName","Transactions","_row$account","_row$type","_row$processedBy","account","date","processedBy","Contacts","_row$id4","_row$familyName","_row$deceasedName2","_row$address2","_row$contactNumber2","_row$status2","familyName","Occupants","_row$id5","_row$name2","_row$niche","intermentDate","niche","Niches","_row$id6","_row$amount","_row$location","_row$status3","amount","Audit","_row$user","_row$role","_row$ipAddress","_row$responseData$ids","_row$responseData","_row$responseData$ids2","_row$action","_row$app","_row$path","user","role","ipAddress","responseData","ids","join","action","app","path","timestamp","year","month","day","hour","minute","second","Users","_row$id7","_row$username","_row$role2","cfg","title","onSearchChange","selectedItems","onSelectAll","onSelectRow","getRowKey","onFilterChange","fieldsToPass","paymentsFields","f","_objectSpread","baseOpts","optsWithPrompt","options","occupantFields","onCreate","fields","editFields","baseEditOpts","editOptsWithPrompt","elementData","onEdit","ref","isOpen"],"sources":["C:/Users/LenovO/Documents/OtherProjects/ColumbariumManagementSystem/frontend/src/pages/dashboard.js"],"sourcesContent":["import Icon from \"../components/icon\";\r\n\r\nimport { useState, useEffect, useRef } from \"react\";\r\nimport { useAuth } from \"../contexts/AuthContext\";\r\nimport StatusTag from '../components/dashboard/statusTag';\r\nimport TabContent from '../components/dashboard/tabContent';\r\n\r\nimport LoadingPage from './loading';\r\nimport CreateNewElement from \"../components/dashboard/createNewElement\";\r\nimport EditElement from \"../components/dashboard/editElement\";\r\nimport AccountModal from \"../components/dashboard/accountModal\";\r\n\r\nimport { fieldsByTab } from \"../config/dashboard/fieldsByTab\";\r\n\r\nimport Tab from '../components/dashboard/tab';\r\n\r\nfunction getCsrf() {\r\n    const cookies = document.cookie.split(';');\r\n    for (let i = 0; i < cookies.length; i++) {\r\n        const cookie = cookies[i].trim();\r\n        if (cookie.startsWith('csrftoken=')) {\r\n            return cookie.substring('csrftoken='.length, cookie.length);\r\n        }\r\n    }\r\n}\r\n\r\nexport default function DashboardPage() {\r\n    const [loading, setLoading] = useState(true);\r\n    const { username, setUsername } = useAuth();\r\n    const [selectedTab, setSelectedTab] = useState(\"Customers\");\r\n    const [sidebarOpen, setSidebarOpen] = useState(true);\r\n    const [searchQuery, setSearchQuery] = useState(\"\");\r\n    const [openCreateModal, setOpenCreateModal] = useState(false);\r\n    const [showEditModal, setShowEditModal] = useState(false);\r\n\r\n    const [tableLoading, setTableLoading] = useState(false);\r\n\r\n    const [selectedElements, setSelectedElements] = useState([]);\r\n    const [elementToEdit, setElementToEdit] = useState(null);\r\n    const [elements, setElements] = useState([])\r\n\r\n    const [openAccountModal, setOpenAccountModal] = useState(false);\r\n    const accountModalRef = useRef(null);\r\n    const [filter, setFilter] = useState(\"\");\r\n    const [customerOptions, setCustomerOptions] = useState([]);\r\n    const [nicheOptions, setNicheOptions] = useState([]);\r\n    \r\n    async function fetchItems(endpoint) {\r\n        setTableLoading(true);\r\n        setElements([]);\r\n        console.log(endpoint, \" fetching items.\");\r\n        try {\r\n            await fetch (`https://columbariummanagementsystembackend.onrender.com//api/${endpoint.toLowerCase()}/list-all/`, {\r\n                method: 'GET',\r\n                headers: {\r\n                    'Content-Type': 'application/json',\r\n                    'Session-Token': sessionStorage.getItem('token'),\r\n                    'Authorization': `Session ${sessionStorage.getItem('token')}`\r\n                },\r\n                credentials: 'include',\r\n            }).then(response => {\r\n                if (!response.ok) {\r\n                    throw new Error(\"Failed to fetch items\");\r\n                } else {\r\n                    return response.json();\r\n                }\r\n            }).then(data => {\r\n                const normalizeKey = (s) => s.replace(/_([a-z])/g, (_, c) => c.toUpperCase());\r\n\r\n                const normalizeObject = (obj) => {\r\n                    if (obj === null || obj === undefined) return obj;\r\n                    if (Array.isArray(obj)) return obj.map(normalizeObject);\r\n                    if (typeof obj !== 'object') return obj;\r\n                    const res = {};\r\n                    Object.keys(obj).forEach(k => {\r\n                        const newKey = normalizeKey(k);\r\n                        const val = obj[k];\r\n                        res[newKey] = normalizeObject(val);\r\n                    });\r\n                    \r\n                    return res;\r\n                }\r\n\r\n                setTableLoading(false);\r\n\r\n                const normalized = Array.isArray(data) ? data.map(normalizeObject) : data;\r\n                setElements(normalized);\r\n                console.log(\"Fetched items (normalized): \", normalized);\r\n            })\r\n        } catch (Exception) {\r\n            console.log(\"Error fetching items: \", Exception);\r\n        }\r\n    }\r\n\r\n    // convert camelCase keys used in the UI back to snake_case for the API\r\n    const camelToSnake = (s) => s.replace(/([A-Z])/g, (m) => '_' + m.toLowerCase());\r\n\r\n    const convertKeysToSnake = (obj) => {\r\n        if (obj === null || obj === undefined) return obj;\r\n        if (Array.isArray(obj)) return obj.map(convertKeysToSnake);\r\n        if (obj instanceof Date) return obj.toISOString();\r\n        if (typeof obj !== 'object') return obj;\r\n\r\n        const res = {};\r\n        Object.keys(obj).forEach((k) => {\r\n            const newKey = camelToSnake(k);\r\n            res[newKey] = convertKeysToSnake(obj[k]);\r\n        });\r\n        return res;\r\n    }\r\n\r\n    const handleEditClick = () => {\r\n         if (selectedElements.length === 1) {\r\n            // ensure customer options are loaded when editing Payments\r\n            const prepareAndShow = async () => {\r\n                if (selectedTab === 'Payments') await fetchCustomerOptions();\r\n                setElementToEdit(elements.find(e => e.id === selectedElements[0]));\r\n                setShowEditModal(true);\r\n            }\r\n            prepareAndShow();\r\n         }\r\n        }\r\n    \r\n\r\n    async function handleRemoveSelected(e) {\r\n        e.preventDefault();\r\n\r\n        if (selectedElements.length === 0) return;\r\n\r\n        const endpoint = selectedTab.toLowerCase();\r\n\r\n        const confirmation = window.confirm(`Are you sure you want to delete ${selectedElements.length} items? This action cannot be undone.`);\r\n\r\n        if (confirmation) {\r\n            try {\r\n                await fetch(`https://columbariummanagementsystembackend.onrender.com//api/${endpoint}/delete/`, {\r\n                    method: 'DELETE',\r\n                    headers: {\r\n                        'Content-Type': 'application/json',\r\n                        'Session-Token': sessionStorage.getItem('token'),\r\n                        'Authorization': `Session ${sessionStorage.getItem('token')}`,\r\n                        'X-CSRFToken': getCsrf(),\r\n                    },\r\n                    body: JSON.stringify({ element_ids: selectedElements }),\r\n                    credentials: 'include',\r\n                })\r\n            } catch (Exception) {\r\n                console.log(\"Error deleting items: \", Exception);\r\n            } finally {\r\n                setSelectedElements([]);\r\n\r\n                await fetchItems(selectedTab);\r\n            }\r\n        }\r\n    }\r\n\r\n    const handleEdit = async(data) => {\r\n        // close on both edit and cancel\r\n        setShowEditModal(false);\r\n        if (data === null) return;\r\n\r\n        const endpoint = selectedTab.toLowerCase();\r\n\r\n        try {\r\n            // convert field names to snake_case before sending to API\r\n            const payload = convertKeysToSnake(data);\r\n\r\n            await fetch(`https://columbariummanagementsystembackend.onrender.com//api/${endpoint}/edit/?${endpoint.slice(0, -1)}_id=${elementToEdit.id}`, {\r\n                method: 'PUT',\r\n                headers: {\r\n                    'Content-Type': 'application/json',\r\n                    'Session-Token': sessionStorage.getItem('token'),\r\n                    'Authorization': `Session ${sessionStorage.getItem('token')}`,\r\n                    'X-CSRFToken': getCsrf(),\r\n                },\r\n                body: JSON.stringify(payload),\r\n                credentials: 'include',\r\n            }).then(response => {\r\n                if (!response.ok) {\r\n                    console.log(\"Failed to edit item\")\r\n                }\r\n\r\n                return response.json();\r\n            }).then(data => {\r\n                console.log(data);\r\n            })\r\n        } catch (Exception) {\r\n\r\n        } finally {\r\n            setSelectedElements([]);\r\n            setElementToEdit(null);\r\n            fetchItems(selectedTab);\r\n        }\r\n    }\r\n\r\n    const handleCreate = async (data) => {\r\n        // close on both create and cancel\r\n        setOpenCreateModal(false);\r\n\r\n        // cancel action (CreateNewElement calls onCreate(null) on cancel)\r\n        console.log('handleCreate received data:', data);\r\n        if (data === null) return;\r\n        const endpoint = selectedTab.toLowerCase();\r\n        try {\r\n            // ensure we have an object to convert\r\n            const safeData = data || {};\r\n            // convert field names to snake_case before sending to API\r\n            const payload = convertKeysToSnake(safeData);\r\n\r\n            console.log('Creating', endpoint, 'payload:', payload);\r\n\r\n            await fetch(\"https://columbariummanagementsystembackend.onrender.com//api/\" + endpoint + \"/create-new/\", {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Content-Type': 'application/json',\r\n                    'Session-Token': sessionStorage.getItem('token'),\r\n                    'Authorization': `Session ${sessionStorage.getItem('token')}`,\r\n                    'X-CSRFToken': getCsrf(),\r\n                },\r\n                body: JSON.stringify(payload),\r\n                credentials: 'include',\r\n            }).then(response => {\r\n                if (!response.ok) {\r\n                    throw new Error(\"Failed to create item\");\r\n                }\r\n\r\n                return response.json();\r\n            }).then(data => {\r\n                console.log(data);\r\n            })\r\n\r\n            await fetchItems(selectedTab);\r\n        } catch (error) {\r\n            console.error(\"Error creating item: \", error);\r\n        }\r\n        \r\n    }\r\n\r\n    useEffect(() => {\r\n        setFilter(\"\");\r\n       const storedUsername = username || sessionStorage.getItem('username');\r\n       if (storedUsername) {\r\n           setUsername(storedUsername);\r\n       }\r\n\r\n       fetchItems(selectedTab);\r\n\r\n       const loader = setTimeout(() => {\r\n           setLoading(false);\r\n       }, 800);\r\n\r\n       return () => {\r\n           clearTimeout(loader);\r\n                \r\n       }\r\n    }, [username, selectedTab, setUsername])\r\n\r\n    // for account modal\r\n    useEffect(() => {\r\n        \r\n        function handleClickOutside(e) {\r\n           if (accountModalRef.current &&\r\n               !accountModalRef.current.contains(e.target)\r\n           ) {\r\n               setOpenAccountModal(false);\r\n           }\r\n        }\r\n\r\n        document.addEventListener('mousedown', handleClickOutside);\r\n\r\n        return () => document.removeEventListener('mousedown', handleClickOutside);\r\n    })\r\n\r\n    const handleTabSelect = (tab) => {\r\n        setElements([])\r\n        setSelectedElements([]);\r\n        setSelectedTab(tab);\r\n        setSearchQuery(\"\");\r\n\r\n        // fetch new items for the selected tab\r\n        console.log(\"Switching to tab:\", tab)\r\n        fetchItems(tab);\r\n    }\r\n\r\n    // fetch customer names to use as options for Payments.payer select\r\n    const fetchCustomerOptions = async () => {\r\n        try {\r\n            const res = await fetch('https://columbariummanagementsystembackend.onrender.com//api/customers/list-all/', {\r\n                method: 'GET',\r\n                headers: {\r\n                    'Content-Type': 'application/json',\r\n                    'Session-Token': sessionStorage.getItem('token'),\r\n                    'Authorization': `Session ${sessionStorage.getItem('token')}`\r\n                },\r\n                credentials: 'include',\r\n            });\r\n            if (!res.ok) throw new Error('Failed to fetch customers');\r\n            const data = await res.json();\r\n\r\n            // normalize keys (reuse normalizeKey logic)\r\n            const normalizeKey = (s) => s.replace(/_([a-z])/g, (_, c) => c.toUpperCase());\r\n            const normalizeObject = (obj) => {\r\n                if (obj === null || obj === undefined) return obj;\r\n                if (Array.isArray(obj)) return obj.map(normalizeObject);\r\n                if (typeof obj !== 'object') return obj;\r\n                const res = {};\r\n                Object.keys(obj).forEach(k => {\r\n                    const newKey = normalizeKey(k);\r\n                    res[newKey] = normalizeObject(obj[k]);\r\n                });\r\n\r\n                setTableLoading(false);\r\n                return res;\r\n            }\r\n\r\n            const normalized = Array.isArray(data) ? data.map(normalizeObject) : [];\r\n                    const opts = normalized.map(c => ({ value: c.name, label: c.name || c.fullName || (`#${String(c.id).padStart(3, '0')}`) }));\r\n            setCustomerOptions(opts);\r\n        } catch (err) {\r\n            console.error('Error fetching customer options', err);\r\n            setCustomerOptions([]);\r\n        }\r\n    }\r\n\r\n    const fetchNicheOptions = async () => {\r\n        try {\r\n            const res = await fetch('https://columbariummanagementsystembackend.onrender.com//api/niches/list-all/', {\r\n                method: 'GET',\r\n                headers: {\r\n                    'Content-Type': 'application/json',\r\n                    'Session-Token': sessionStorage.getItem('token'),\r\n                    'Authorization': `Session ${sessionStorage.getItem('token')}`\r\n                },\r\n                credentials: 'include',\r\n            });\r\n            if (!res.ok) throw new Error('Failed to fetch niches');\r\n            const data = await res.json();\r\n\r\n            const available = data.filter(n => n.status === 'Available');\r\n\r\n            // normalize keys (reuse normalizeKey logic)\r\n            const normalizeKey = (s) => s.replace(/_([a-z])/g, (_, c) => c.toUpperCase());\r\n            const normalizeObject = (obj) => {\r\n                if (obj === null || obj === undefined) return obj;\r\n                if (Array.isArray(obj)) return obj.map(normalizeObject).filter(entry => entry.status === 'Available');\r\n                if (typeof obj !== 'object') return obj;\r\n                const res = {};\r\n                Object.keys(obj).forEach(k => {\r\n                    const newKey = normalizeKey(k);\r\n                    res[newKey] = normalizeObject(obj[k]);\r\n                });\r\n\r\n                console.log(res);\r\n                setTableLoading(false);\r\n                return res;\r\n            }\r\n            const normalized = Array.isArray(available) ? available.map(normalizeObject) : [];\r\n            const opts = normalized.map(n => ({ value: n.id, label: (`${n.location ?? 'No location'} - #${String(n.id).padStart(3, '0')}`) || (`#${String(n.id).padStart(3, '0')}`) }));\r\n            setNicheOptions(opts);\r\n        } catch (err) {\r\n            console.error('Error fetching niche options', err);\r\n            setNicheOptions([]);\r\n        }\r\n    }\r\n\r\n    \r\n    \r\n\r\n    const handleSelectRow = (id) => {\r\n        console.log(id);\r\n        setSelectedElements((prev) => \r\n            prev.includes(id) ? prev.filter((ppid) => ppid !== id) : [...prev, id]\r\n        )\r\n    }\r\n    \r\n    const handleSelectAll = (checked) => {\r\n        if (checked) setSelectedElements(elements.map((p) => p.id));\r\n        else setSelectedElements([]);\r\n    }\r\n\r\n    if (loading) return <LoadingPage />;    \r\n\r\n    return (\r\n        <div className=\"min-h-screen screen overflow-auto items-center flex flex-col bg-[#fbfbfb]\">\r\n            <title>Dashboard</title>\r\n            <div className=\"min-w-[90%] min-h-[80%] max-w-[100%] max-h-[100%]\">\r\n                <div className=\"header bg-white w-full self-center flex flex-row justify-between mt-3 rounded-lg p-4 drop-shadow-md\">\r\n                    <div className=\"flex flex-row items-center\">\r\n                        <button onClick={(e) => {setSidebarOpen(!sidebarOpen)}} className=\"p-2 text-[22px] rounded-full hover:bg-black/10 text-zinc-700 mr-4\"><Icon icon=\"fa-solid fa-bars\"></Icon></button>\r\n                        <h1 className=\"text-3xl font-bold text-zinc-700\">Columbarium Dashboard</h1>\r\n                    </div>\r\n                    <div id=\"accountControl\" className=\"flex flex-row items-center\">\r\n                        <button onClick={() => setOpenAccountModal(!openAccountModal)} className=\"p-2 hover:underline text-md text-zinc-700 mr-4\"><Icon icon=\"fa-solid fa-user\" className=\"mr-3\"></Icon>{username !== \"\" ? username : \"User Not Found\"}</button>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"lg:w-[100%] md:w-[90%] h-[85%] flex flex-row gap-3\">\r\n                    {/* Sidebar */}\r\n                    { sidebarOpen &&\r\n                    <div className=\"sidebar bg-white w-[20%] h-full self-start flex flex-col mt-3 rounded-lg p-4 drop-shadow-md gap-1\">\r\n\r\n                        {/* Tabs */}\r\n                        <Tab onClick={() => handleTabSelect(\"Customers\")} icon=\"fa-solid fa-users\">Customers</Tab>\r\n\r\n                        <Tab onClick={() => handleTabSelect(\"Payments\")} icon=\"fa-solid fa-credit-card\">Payments</Tab>\r\n\r\n                        <Tab onClick={() => handleTabSelect(\"Accounts\")} icon=\"fa-solid fa-wallet\">Accounts</Tab>\r\n\r\n                        <Tab onClick={() => handleTabSelect(\"Contacts\")} icon=\"fa-solid fa-address-book\">Contacts</Tab>\r\n\r\n                        <Tab onClick={() => handleTabSelect(\"Occupants\")} icon=\"fa-solid fa-box-open\">Occupants</Tab>\r\n\r\n                        <Tab onClick={() => handleTabSelect(\"Niches\")} icon=\"fa-solid fa-square-person-confined\">Niches</Tab>\r\n\r\n                        {/* Audit Logs*/}\r\n                        {sessionStorage.getItem(\"permissions\").split(\",\").includes(\"view_audit\") && <Tab onClick={() => handleTabSelect(\"Audit\")} icon=\"fa-solid fa-users\">Audit Logs</Tab>}\r\n\r\n                        {/* User Account Control */}\r\n                        {sessionStorage.getItem(\"permissions\").split(\",\").includes(\"manage_users\") &&\r\n                        <Tab onClick={() => handleTabSelect(\"Users\")} icon=\"fa-solid fa-user-shield\">User Management</Tab>}\r\n\r\n\r\n                        <Tab onClick={() => handleTabSelect(\"Analytics\")} icon=\"fa-solid fa-chart-simple\">Analytics</Tab>\r\n                    </div>}\r\n\r\n                    \r\n                    {/* Main Content */}\r\n                    <div className=\"content transition-all duration-300 ease-out bg-white w-full h-full flex flex-col mt-3 rounded-lg p-4 drop-shadow-md overflow-auto\">\r\n\r\n                        {/* Dynamic Tab Content rendered from a small config to keep things DRY */}\r\n                        {(() => {\r\n                            const tabs = {\r\n                                Customers: {\r\n                                    columns: [\r\n                                        {label: \"\", key: \"_select\" },\r\n                                        { label: \"Customer ID\", key: \"id\", type: 'number' },\r\n                                        { label: \"Full Name\", key: \"name\", type: 'text' },\r\n                                        { label: \"Contact Number\", key: \"contactNumber\", type: 'text' },\r\n                                        { label: \"Email\", key: \"email\", type: 'text' },\r\n                                        { label: \"Address\", key: \"address\", type: 'text' },\r\n                                        { label: \"Deceased's Name\", key: \"deceasedName\", type: 'text' },\r\n                                        { label: \"Date Deceased\", key: \"deceasedDate\", type: 'date' },\r\n                                        { label: \"Relationship to Deceased\", key: \"relationshipToDeceased\", type: 'text' }\r\n                                    ],\r\n                                    toolbarButtons: [\r\n                                        { label: 'Add Customer', icon: 'fa-solid fa-plus', bg: 'bg-blue-500', textClass: 'text-white', onClick: () => setOpenCreateModal(true) },\r\n                                        { label: 'Edit Selected', icon: 'fa-solid fa-pencil', onClick: (e) => { handleEditClick(e) } },\r\n                                        { label: `(${selectedElements.length}) Remove Selected`, icon: 'fa fa-trash', bg: 'bg-red-500', textClass: 'text-white', onClick: (e) => { handleRemoveSelected(e) } },\r\n                                    ],\r\n                                    rowRenderer: (row) => (\r\n                                        <>\r\n                                            <td className=\"p-2\">#{(row.id ?? '').toString().padStart(3, \"0\")}</td>\r\n                                            <td className=\"p-2\">{row.name ?? ''}</td>\r\n                                            <td className=\"p-2\">{row.contactNumber ?? ''}</td>\r\n                                            <td className=\"p-2\">{row.email ?? ''}</td>\r\n                                            <td className=\"p-2\">{row.address ?? ''}</td>\r\n                                            <td className=\"p-2\">{row.deceasedName ?? ''}</td>\r\n                                            <td className=\"p-2\">{row.deceasedDate ?? ''}</td>\r\n                                            <td className=\"p-2\">{row.relationshipToDeceased ?? ''}</td>\r\n                                        </>\r\n                                    )\r\n                                },\r\n                                Payments: {\r\n                                    columns: [\r\n                                        { label: \"\", key: \"_select\" },\r\n                                        { label: \"Payment ID\", key: \"id\", type: 'number' },\r\n                                        { label: \"Customer Name\", key: \"payer\", type: 'text' },\r\n                                        { label: \"Amount Paid\", key: \"amountPaid\", type: 'number' },\r\n                                        { label: \"Amount Due\", key: \"amountDue\", type: 'number' },\r\n                                        { label: \"Remaining Balance\", key: \"remainingBalance\", type: 'number' },\r\n                                        { label: \"Maintenance Fee\", key: \"maintenanceFee\", type: 'number' },\r\n                                        { label: \"Date Paid\", key: \"paymentDate\", type: 'date' },\r\n                                        { label: \"Status\", key: \"status\", type: 'text' }\r\n                                    ],\r\n                                    toolbarButtons: [\r\n                                        { label: 'Add Payment', icon: 'fa-solid fa-plus', bg: 'bg-blue-500', textClass: 'text-white', onClick: async () => { await fetchCustomerOptions(); setOpenCreateModal(true); } },\r\n                                        { label: 'Edit Selected', icon: 'fa-solid fa-pencil', onClick: (e) => { handleEditClick(e) } },\r\n                                        { label: `(${selectedElements.length}) Remove Selected`, icon: 'fa fa-trash', bg: 'bg-red-500', textClass: 'text-white', onClick: (e) => { handleRemoveSelected(e) } },\r\n                                    ],\r\n                                    rowRenderer: (row) => (\r\n                                        <>\r\n                        <td className=\"p-2\">#{(row.id ?? '').toString().padStart(3, \"0\")}</td>\r\n                        <td className=\"p-2\">{(function(){\r\n                            // prefer 'payer' field; it may contain either the customer id or the name\r\n                            const payerVal = row.payer ?? row.payer_id ?? row.payerId ?? null;\r\n                            // if payerVal matches an option value, show the option label\r\n                            const opt = customerOptions.find(o => String(o.value) === String(payerVal));\r\n                            if (opt) return opt.label;\r\n                            // otherwise show the raw value (name) if present\r\n                            return payerVal ?? '';\r\n                        })()}</td>\r\n                        <td className=\"p-2\"> {Number(row.amountPaid ?? row.amountPaid ?? row.amount_paid ?? 0).toLocaleString(\"en-US\", {minimumFractionDigits: 2 })}</td>\r\n                        <td className=\"p-2\"> {Number(row.amountDue ?? row.amount_due ?? 0).toLocaleString(\"en-US\", { minimumFractionDigits: 2 })}</td>\r\n                        <td className=\"p-2\"> {Number(row.remainingBalance ?? row.remaining_balance ?? 0).toLocaleString(\"en-US\", { minimumFractionDigits: 2 })}</td>\r\n                        <td className=\"p-2\"> {Number(row.maintenanceFee ?? row.maintenance_fee ?? 0).toLocaleString(\"en-US\", { minimumFractionDigits: 2 })}</td>\r\n                        <td className=\"p-2\">{row.paymentDate ? new Intl.DateTimeFormat('en-US').format(new Date(row.paymentDate)) : ''}</td>\r\n                        <td className=\"p-2\"><StatusTag status={row.status ?? row.state ?? ''} />\r\n                                    </td>\r\n                                        </>\r\n                                    )\r\n                                },\r\n\r\n                                Accounts: {\r\n                                    columns: [\r\n                                        { label: \"\", key: \"_select\" },\r\n                                        { label: \"Account ID\", key: \"id\", type: 'number' },\r\n                                        { label: \"Customer Name\", key: \"customerName\", type: 'text'}\r\n                                    ],\r\n                                    toolbarButtons: [\r\n                                        \r\n                                    ],\r\n                                    rowRenderer: (row) => {\r\n                                        <>\r\n                                            <td className=\"p-2\">{ row.id ?? '' }</td>\r\n                                            <td className=\"p-2\">{ row.customerName ?? '' }</td>\r\n                                        </>\r\n                                    }\r\n                                },\r\n\r\n                                Transactions: {\r\n                                    columns: [\r\n                                        { label: \"\", key: \"_select\" },\r\n                                        { label: \"Transaction #\", key: \"id\", type: 'number' },\r\n                                        { label: \"Account\", key: \"account\", type: 'text' },\r\n                                        { label: \"Date of Transaction\", key:\"date\", type: 'date'},\r\n                                        { label: \"Type of Transaction\", key:\"type\", type: \"text\"},\r\n                                        { label: \"Processed By\", key:\"processedBy\", type:\"text\"},\r\n                                    ],\r\n\r\n                                    toolbarButtons: [\r\n                                        { label: \"Add Transaction\", icon: \"fa-solid fa-plus\", onClick: setOpenCreateModal },\r\n                                        { label: \"Edit Selected\", icon: \"fa-solid fa-pen-to-square\", onClick: handleEditClick },\r\n                                        { label: \"Remove Selected\", icon: \"fa-solid fa-trash\", onClick: handleRemoveSelected },\r\n                                    ],\r\n\r\n                                    rowRenderer: (row) => (\r\n                                        <>\r\n                                            <td className=\"p-2\">{ row.id ? row.id.padStart(3, \"0\") : '' }</td>\r\n                                            <td className=\"p-2\">{ row.account ?? '' }</td>\r\n                                            <td className=\"p-2\">{ row.date ? new Intl.DateTimeFormat('en-US').format(new Date(row.date)) : '' }</td>\r\n                                            <td className=\"p-2\">{ row.type ?? '' }</td>\r\n                                            <td className=\"p-2\">{ row.processedBy ?? '' }</td>\r\n                                        </>\r\n                                    )\r\n\r\n\r\n                                },\r\n\r\n                                Contacts: {\r\n                                    columns: [\r\n                                        { label: \"\", key: \"_select\" },\r\n                                        { label: \"Contact ID\", key: \"id\", type: 'number' },\r\n                                        { label: \"Family Name\", key: \"familyName\", type: 'text' },\r\n                                        { label: \"Deceased's Name\", key: \"deceasedName\", type: 'text' },\r\n                                        { label: \"Deceased Date\", key: \"deceasedDate\", type: 'date' },\r\n                                        { label: \"Address\", key: \"address\", type: 'text' },\r\n                                        { label: \"Contact Number\", key: \"contactNumber\", type: 'text' }\r\n                                    ],\r\n                                    toolbarButtons: [\r\n                                        { label: 'Add Contact', icon: 'fa-solid fa-plus', bg: 'bg-blue-500', textClass: 'text-white', onClick: () => setOpenCreateModal(true) },\r\n                                        { label: 'Edit Selected', icon: 'fa-solid fa-pencil', onClick: (e) => { handleEditClick(e) } },\r\n                                        { label: `(${selectedElements.length}) Remove Selected`, icon: 'fa fa-trash', textClass:'text-white', bg: 'bg-red-500 text-white', onClick: handleRemoveSelected },\r\n                                    ],\r\n                                    rowRenderer: (row) => (\r\n                                        <>\r\n                                            <td className=\"p-2\">#{(row.id ?? '').toString().padStart(3, \"0\")}</td>\r\n                                            <td className=\"p-2\">{row.familyName ?? ''}</td>\r\n                                            <td className=\"p-2\">{row.deceasedName ?? ''}</td>\r\n                                            <td className=\"p-2\">{row.deceasedDate ? new Intl.DateTimeFormat('en-US').format(new Date(row.deceasedDate)) : ''}</td>\r\n                                            <td className=\"p-2\">{row.address ?? ''}</td>\r\n                                            <td className=\"p-2\">{row.contactNumber ?? ''}</td>\r\n                                            <td className=\"p-2\"><StatusTag status={row.status ?? ''} />\r\n                                    </td>\r\n                                        </>\r\n                                    )\r\n                                },\r\n                                Occupants: {\r\n                                    columns: [\r\n                                        { label: \"\", key: \"_select\" },\r\n                                        { label: \"Occupant ID\", key: \"id\", type: 'number' },\r\n                                        { label: \"Name\", key: \"name\", type: 'text' },\r\n                                        { label: \"Date of Interment\", key: \"intermentDate\", type: 'date' },\r\n                                        { label: \"Niche\", key: \"niche\", type: 'text' }\r\n                                    ],\r\n                                    toolbarButtons: [\r\n                                        { label: 'Add Occupant', icon: 'fa-solid fa-plus', bg: 'bg-blue-500', textClass: 'text-white', onClick: async () => { await fetchNicheOptions(); setOpenCreateModal(true) }},\r\n                                        { label: 'Edit Selected', icon: 'fa-solid fa-pencil', onClick: (e) => { handleEditClick(e) } },\r\n                                        { label: `(${selectedElements.length}) Remove Selected`, icon: 'fa fa-trash', bg: 'bg-red-500', textClass: 'text-white', onClick: handleRemoveSelected },\r\n                                    ],\r\n                                    rowRenderer: (row) => (\r\n                                        <>\r\n                                            <td className=\"p-2\">#{(row.id ?? '').toString().padStart(3, \"0\")}</td>\r\n                                            <td className=\"p-2\">{row.name ?? ''}</td>\r\n                                            <td className=\"p-2\">{row.intermentDate ? new Intl.DateTimeFormat('en-US').format(new Date(row.intermentDate)) : ''}</td>\r\n                                            <td className=\"p-2\">{row.niche ?? ''}</td>\r\n                                        </>\r\n                                    )   \r\n                                },\r\n                                Niches: {\r\n                                    columns: [\r\n                                        { label: \"\", key: \"_select\" },\r\n                                        { label: \"Niche ID\", key: \"id\", type: 'number' },\r\n                                        { label: \"Amount\", key: \"amount\", type: 'number' },\r\n                                        { label: \"Location\", key: \"location\", type: 'text' },\r\n                                        { label: \"Status\", key: \"status\", type: 'text' }\r\n                                    ],\r\n                                    toolbarButtons: [\r\n                                        { label: 'Add Niche', icon: 'fa-solid fa-plus', bg: 'bg-blue-500', textClass: 'text-white', onClick: () => setOpenCreateModal(true) },\r\n                                        { label: 'Edit Selected', icon: 'fa-solid fa-pencil', onClick: handleEditClick },\r\n                                        { label: `(${selectedElements.length}) Remove Selected`, icon: 'fa fa-trash', bg: 'bg-red-500', textClass: 'text-white', onClick: handleRemoveSelected },\r\n                                    ],\r\n                                    rowRenderer: (row) => (\r\n                                        <>\r\n                                            <td className=\"p-2\">#{(row.id ?? '').toString().padStart(3, \"0\")}</td>\r\n                                            <td className=\"p-2\"> {Number(row.amount ?? 0).toLocaleString('en-US', { minimumFractionDigits: 2})}</td>\r\n                                            <td className=\"p-2\">{row.location ?? ''}</td>\r\n                                            <td className=\"p-2\"><StatusTag status={row.status ?? ''} /></td>\r\n                                        </>\r\n                                    )\r\n                                },\r\n                                Audit: {\r\n                                    columns: [\r\n                                        { label: \"User\", key: \"user\", type: 'text' },\r\n                                        { label: \"Role\", key: \"role\", type: 'text' },\r\n                                        { label: \"IP Address\", key: \"ipAddress\", type: 'text' },\r\n                                        { label: \"Object ID\", key: \"objectId\", type: 'text' },\r\n                                        { label: \"Action\", key: \"action\", type: 'text' },\r\n                                        { label: \"Application\", key: \"app\", type: 'text' },\r\n                                        { label: \"URL\", key: \"path\", type: 'text' },\r\n                                        { label: \"Timestamp\", key: \"timestamp\", type: 'date' },\r\n                                    ],\r\n                                    toolbarButtons: [],\r\n                                    rowRenderer: (row) => (\r\n                                        <>\r\n                                            <td className=\"p-2\">{row.user ?? ''}</td>\r\n                                            <td className=\"p-2\">{row.role ?? ''}</td>\r\n                                            <td className=\"p-2\">{row.ipAddress ?? ''}</td>\r\n                                            <td className=\"p-2\">{row.responseData?.ids?.join(', ') ?? ''}</td>\r\n                                            <td className=\"p-2\">{row.action ?? ''}</td>\r\n                                            <td className=\"p-2\">{row.app ?? ''}</td>\r\n                                            <td className=\"p-2\">{row.path ?? ''}</td>\r\n                                            <td className=\"p-2\">{row.timestamp ? new Intl.DateTimeFormat('en-US', {year:'numeric', month:'numeric',day:'numeric', hour:'numeric', minute:'numeric', second:'numeric'}).format(new Date(row.timestamp)) : ''}</td>\r\n                                        </>\r\n                                    )\r\n                                },\r\n                                Users: {\r\n                                    columns: [\r\n                                        { label: \"\", key: \"_select\" },\r\n                                        { label: \"User ID\", key: \"id\", type: 'number' },\r\n                                        { label: \"Username\", key: \"username\", type: 'text' },\r\n                                        { label: \"Role\", key: \"role\", type: 'text' },\r\n                                    ],\r\n                                    toolbarButtons: [\r\n                                        { label: 'Add User', icon: 'fa-solid fa-plus', bg: 'bg-blue-500', textClass: 'text-white', onClick: () => setOpenCreateModal(true) },\r\n                                        { label: 'Edit Selected', icon: 'fa-solid fa-pencil', onClick: handleEditClick },\r\n                                        { label: `(${selectedElements.length}) Remove Selected`, icon: 'fa fa-trash', bg: 'bg-red-500', textClass: 'text-white', onClick: handleRemoveSelected },\r\n                                    ],\r\n                                    rowRenderer: (row) => (\r\n                                        <>\r\n                                            \r\n                                            <td className=\"p-2\">{row.id ?? ''}</td>\r\n                                            <td className=\"p-2\">{row.username ?? ''}</td>\r\n                                            <td className=\"p-2\">{row.role ?? ''}</td>\r\n                                        </>\r\n                                    )\r\n                                }\r\n                                // Add other tabs here\r\n                            }\r\n\r\n                            const cfg = tabs[selectedTab];\r\n                            if (!cfg) return null;\r\n\r\n                            if (tableLoading) return <LoadingPage />;\r\n\r\n                            return (\r\n                                <TabContent\r\n                                    title={selectedTab}\r\n                                    searchQuery={searchQuery}\r\n                                    onSearchChange={setSearchQuery}\r\n                                    toolbarButtons={cfg.toolbarButtons}\r\n                                    columns={cfg.columns}\r\n                                    data={elements.length > 0 ? elements : []}\r\n                                    selectedItems={selectedElements}\r\n                                    onSelectAll={handleSelectAll}\r\n                                    onSelectRow={handleSelectRow}\r\n                                    getRowKey={(row) => row.id}\r\n                                    onFilterChange={(value) => setFilter(value)}\r\n                                >\r\n                                    {cfg.rowRenderer}\r\n                                </TabContent>\r\n                            )\r\n                            \r\n                        })()}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            { openCreateModal && (() => {\r\n                let fieldsToPass = fieldsByTab[selectedTab];\r\n                if (selectedTab === 'Payments') {\r\n                    // ensure options are available\r\n                    const paymentsFields = (fieldsByTab.Payments || []).map(f => ({ ...f }));\r\n                    // replace payerId field with select options\r\n                    const baseOpts = customerOptions.length ? customerOptions : [{ value: '', label: 'No customers' }];\r\n                    const optsWithPrompt = [{ value: '', label: 'Select Customer' }, ...baseOpts];\r\n                    fieldsToPass = paymentsFields.map(f => f.name === 'payer' ? ({ ...f, type: 'select', options: optsWithPrompt }) : f);\r\n                } else if (selectedTab === 'Occupants') {\r\n                    const occupantFields = (fieldsByTab.Occupants || []).map(f => ({ ...f }));\r\n                    const baseOpts = nicheOptions.length ? nicheOptions : [{ value: '', label: 'No niches' }];\r\n                    const optsWithPrompt = [{ value: '', label: 'Select Niche' }, ...baseOpts];\r\n                    fieldsToPass = occupantFields.map(f => f.name === 'nicheId' ? ({ ...f, type: 'select', options: optsWithPrompt }) : f);\r\n                }\r\n\r\n                return <CreateNewElement tab={selectedTab} onCreate={handleCreate} fields={fieldsToPass} />\r\n            })() }\r\n            { /* EditElement modal can be added here similarly when needed */ }\r\n            { showEditModal && (() => {\r\n                let editFields = fieldsByTab[selectedTab];\r\n                if (selectedTab === 'Payments') {\r\n                    const paymentsFields = (fieldsByTab.Payments || []).map(f => ({ ...f }));\r\n                    const baseEditOpts = customerOptions.length ? customerOptions : [{ value: '', label: 'No customers' }];\r\n                    const editOptsWithPrompt = [{ value: '', label: 'Select Customer' }, ...baseEditOpts];\r\n                    editFields = paymentsFields.map(f => f.name === 'payer' ? ({ ...f, type: 'select', options: editOptsWithPrompt }) : f);\r\n                }\r\n                return <EditElement tab={selectedTab} elementData={elementToEdit} fields={editFields} onEdit={handleEdit} />\r\n            })()}\r\n\r\n            <div ref={accountModalRef}>\r\n                <AccountModal isOpen={openAccountModal} username={username} role={sessionStorage.getItem(\"role\") || 'Staff'} />\r\n            </div>\r\n        </div>\r\n    )\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}